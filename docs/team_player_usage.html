<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Team Player Usage Patterns</title>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    :root {
      --red: #ef4444;
      --blue: #0ea5e9;
      --grid: #e8eaed;
      --axis: #9aa0a6;
      --text: #222;
    }
    body { margin: 16px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: var(--text); background: #f7f7f7; }
    .container { max-width: 1200px; margin: 0 auto; background: #fff; border: 1px solid #e5e5e5; border-radius: 10px; padding: 12px 16px 22px; box-shadow: 0 1px 3px rgba(0,0,0,.06); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    .subtitle { color: #666; font-size: 13px; margin: 4px 0 12px; }
    .controls { display: flex; align-items: center; gap: 10px; margin: 6px 0 8px; }
    .panel { margin: 12px 0 14px; border: 1px solid #e5e5e5; border-radius: 10px; overflow: hidden; background: #fff; }
    .panel > summary { padding: 10px 14px; background: #f5f7fa; border-bottom: 1px solid #ebeff5; font-weight: 600; cursor: pointer; user-select: none; list-style: none; }
    .panel[open] > summary { border-bottom-color: #e6eaf0; }
    .chart-wrap { padding: 8px 8px 0; }
    .legend { display: flex; align-items: center; gap: 16px; color: #555; font-size: 12px; padding: 0 10px 10px; }
    .swatch { display: inline-block; width: 12px; height: 12px; border-radius: 2px; margin-right: 6px; vertical-align: middle; }
    .avg { background: repeating-linear-gradient(90deg, #bbb, #bbb 2px, transparent 2px, transparent 6px); border: 1px solid #bbb; }
    .red { background: var(--red); opacity: .5; }
    .blue { background: var(--blue); opacity: .5; }
    .tooltip { position: absolute; pointer-events: none; background: rgba(0,0,0,.78); color: #fff; padding: 6px 8px; border-radius: 6px; font-size: 12px; z-index: 10; }
    .info { background: #f3f6fa; border: 1px solid #e1e7ef; border-radius: 8px; padding: 10px 14px; color: #243246; font-size: 14px; margin: 8px 0 12px; }
    .correlation-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
    .corr-strong { background: #dcfce7; color: #166534; }
    .corr-moderate { background: #fef3c7; color: #854d0e; }
    .corr-weak { background: #fee2e2; color: #991b1b; }
    .help-icon { display: inline-block; width: 16px; height: 16px; border-radius: 50%; background: #3b82f6; color: white; text-align: center; line-height: 16px; font-size: 11px; font-weight: bold; margin-left: 8px; cursor: help; vertical-align: middle; }
    .metric-tooltip { position: absolute; pointer-events: none; background: rgba(30,64,175,.95); color: #fff; padding: 8px 12px; border-radius: 6px; font-size: 12px; z-index: 100; max-width: 350px; line-height: 1.5; box-shadow: 0 4px 6px rgba(0,0,0,.3); }
  </style>
  <script>
    async function tryCsv(paths) {
      let lastErr;
      for (const p of paths) {
        try { return await d3.csv(p, d3.autoType); } catch (e) { lastErr = e; }
      }
      throw lastErr || new Error('Unable to load CSV: ' + paths.join(', '));
    }

    function fmt1(x) { return d3.format('.1f')(x); }
    function fmt2(x) { return d3.format('.2f')(x); }
    function fmt3(x) { return d3.format('.3f')(x); }
    function toPct(x) { return d3.format('.1%')(x); }
    function toPct0(x) { return d3.format('.0%')(x); }

    function regression(points) {
      let n = 0, sx = 0, sy = 0, sxy = 0, sxx = 0, syy = 0;
      for (const [x0, y0] of points) {
        const x = +x0, y = +y0;
        if (!Number.isFinite(x) || !Number.isFinite(y)) continue;
        n++; sx += x; sy += y; sxy += x*y; sxx += x*x; syy += y*y;
      }
      if (n < 2) return { m: 0, b: sy / (n || 1), r2: 0 };
      const denom = n * sxx - sx * sx;
      const m = denom !== 0 ? (n * sxy - sx * sy) / denom : 0;
      const b = (sy - m * sx) / n;
      
      const ssr = points.reduce((sum, [x0, y0]) => {
        const x = +x0, y = +y0;
        if (!Number.isFinite(x) || !Number.isFinite(y)) return sum;
        return sum + Math.pow(y - (m * x + b), 2);
      }, 0);
      const sst = syy - (sy * sy) / n;
      const r2 = sst !== 0 ? Math.max(0, 1 - ssr / sst) : 0;
      
      return { m, b, r2 };
    }

    async function loadData() {
      const stats = await tryCsv([
        '../output/team_player_usage.csv',
        'output/team_player_usage.csv',
        '/output/team_player_usage.csv'
      ]);

      for (const row of stats) {
        row.logoUrl = (row.logoId !== '' && row.logoId != null) ? 
          `https://cdn.neonsportz.com/teamlogos/256/${row.logoId}.png` : null;
      }

      return stats;
    }

    function drawScatter(holder, rows, cfg) {
      rows = rows.filter(d => 
        Number.isFinite(+d[cfg.xKey]) && Number.isFinite(+d[cfg.yKey])
      );

      if (rows.length < 2) return;

      const margin = { top: 20, right: 24, bottom: 46, left: 70 };
      const width = 1080, height = 480;
      const innerW = width - margin.left - margin.right;
      const innerH = height - margin.top - margin.bottom;

      const panel = holder.append('details').attr('class', 'panel').attr('open', true);
      const summary = panel.append('summary');
      summary.append('span').text(cfg.title);
      
      if (cfg.metricHelp) {
        const helpIcon = summary.append('span').attr('class', 'help-icon').text('?');
        const metricTip = d3.select('body').append('div').attr('class', 'metric-tooltip').style('display', 'none');
        helpIcon.on('mouseenter', function(evt) {
          metricTip.style('display', 'block').html(cfg.metricHelp);
        }).on('mousemove', (evt) => {
          metricTip.style('left', (evt.pageX + 12) + 'px').style('top', (evt.pageY - 28) + 'px');
        }).on('mouseleave', () => {
          metricTip.style('display', 'none');
        });
      }
      
      const wrap = panel.append('div').attr('class', 'chart-wrap');
      const svg = wrap.append('svg').attr('width', width).attr('height', height);
      const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);

      const yVals = rows.map(d => +d[cfg.yKey]);
      const yMin = d3.min(yVals), yMax = d3.max(yVals);
      const yRange = yMax - yMin;
      const yPad = yRange * 0.15 || 0.5;
      const y = d3.scaleLinear()
        .domain([yMin - yPad, yMax + yPad])
        .range([innerH, 0]);

      const xVals = rows.map(d => +d[cfg.xKey]);
      const xMin = d3.min(xVals), xMax = d3.max(xVals);
      const xRange = xMax - xMin;
      const xPad = xRange * 0.15 || 0.5;
      const x = d3.scaleLinear()
        .domain([xMin - xPad, xMax + xPad])
        .range([0, innerW]);

      g.append('g').attr('transform', `translate(0,${innerH})`)
        .call(d3.axisBottom(x).ticks(10).tickFormat(cfg.xFormat || fmt2).tickSize(-innerH).tickPadding(8))
        .call(s => s.selectAll('.tick line').attr('stroke', '#e2e2e2'))
        .call(s => s.select('.domain').attr('stroke', '#9aa0a6'));

      g.append('g')
        .call(d3.axisLeft(y).ticks(10).tickFormat(cfg.yFormat || fmt2).tickSize(-innerW).tickPadding(6))
        .call(s => s.selectAll('.tick line').attr('stroke', '#efefef'))
        .call(s => s.select('.domain').attr('stroke', '#dcdcdc'));

      const yAvg = d3.mean(yVals), xAvg = d3.mean(xVals);
      g.append('line').attr('x1', 0).attr('x2', innerW).attr('y1', y(yAvg)).attr('y2', y(yAvg))
        .attr('stroke', '#999').attr('stroke-dasharray', '6,4').attr('stroke-width', 1.5);
      g.append('line').attr('x1', x(xAvg)).attr('x2', x(xAvg)).attr('y1', 0).attr('y2', innerH)
        .attr('stroke', '#9aa0a6').attr('stroke-dasharray', '6,4').attr('stroke-width', 1.5);
      g.append('text').attr('x', 6).attr('y', y(yAvg)-6).attr('fill', '#555').attr('font-size', 11)
        .text('Avg Y: ' + (cfg.yFormat || fmt2)(yAvg));
      g.append('text').attr('x', x(xAvg)+6).attr('y', 12).attr('fill', '#555').attr('font-size', 11)
        .text('Avg X: ' + (cfg.xFormat || fmt2)(xAvg));

      const { m, b, r2 } = regression(rows.map(d => [+d[cfg.xKey], +d[cfg.yKey]]));
      const xRangePts = [d3.min(xVals), d3.max(xVals)];
      g.append('line')
        .attr('x1', x(xRangePts[0])).attr('y1', y(m*xRangePts[0] + b))
        .attr('x2', x(xRangePts[1])).attr('y2', y(m*xRangePts[1] + b))
        .attr('stroke', '#777').attr('stroke-width', 2).attr('opacity', .95);

      const tip = d3.select('body').append('div').attr('class', 'tooltip').style('display', 'none');

      const size = 30;
      const node = g.selectAll('.team').data(rows, d => d.team).join('g').attr('class', 'team')
        .attr('transform', d => `translate(${x(d[cfg.xKey])},${y(d[cfg.yKey])})`)
        .on('mouseenter', function(evt, d){
          const trend = m * d[cfg.xKey] + b;
          const res = d[cfg.yKey] - trend;
          let html = `<strong>${d.team}</strong><br>`;
          html += `${cfg.xLabel}: ${(cfg.xFormat || fmt2)(d[cfg.xKey])}<br>`;
          html += `${cfg.yLabel}: ${(cfg.yFormat || fmt2)(d[cfg.yKey])}<br>`;
          html += `Win%: ${toPct(d.win_pct)}<br>`;
          if (cfg.extraInfo) html += cfg.extraInfo(d) + '<br>';
          html += `Δ vs trend: ${(res>=0?'+':'') + fmt2(res)}<br>`;
          
          const qx = +d[cfg.xKey] >= xAvg;
          const qy = +d[cfg.yKey] >= yAvg;
          let quadrant = '';
          if (cfg.quadrantHelp) {
            if (qx && qy) quadrant = '<em>' + cfg.quadrantHelp.topRight + '</em>';
            else if (!qx && qy) quadrant = '<em>' + cfg.quadrantHelp.topLeft + '</em>';
            else if (!qx && !qy) quadrant = '<em>' + cfg.quadrantHelp.bottomLeft + '</em>';
            else quadrant = '<em>' + cfg.quadrantHelp.bottomRight + '</em>';
          } else {
       	  	if (qx && qy) quadrant = '<em>Oben rechts: Hoher X-Wert, Hoher Y-Wert</em>';
             else if (!qx && qy) quadrant = '<em>Oben links: Niedriger X-Wert, Hoher Y-Wert</em>';
             else if (!qx && !qy) quadrant = '<em>Unten links: Niedriger X-Wert, Niedriger Y-Wert</em>';
             else quadrant = '<em>Unten rechts: Hoher X-Wert, Niedriger Y-Wert</em>';
          }
          html += quadrant;
          
          tip.style('display','block').html(html);
        })
        .on('mousemove', (evt)=> tip.style('left', (evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px'))
        .on('mouseleave', ()=> tip.style('display','none'));

      node.append('rect')
        .attr('x', -(size/2 + 2)).attr('y', -(size/2 + 2))
        .attr('width', size + 4).attr('height', size + 4)
        .attr('rx', 4).attr('ry', 4)
        .attr('fill', d => (+d[cfg.yKey] >= m*+d[cfg.xKey] + b) ? 'var(--red)' : 'var(--blue)')
        .attr('opacity', .16);

      node.append('image')
        .attr('href', d => d.logoUrl || null)
        .attr('x', -size/2).attr('y', -size/2)
        .attr('width', size).attr('height', size)
        .attr('opacity', .95);

      svg.append('text').attr('x', margin.left + innerW/2).attr('y', height-10)
        .attr('text-anchor', 'middle').attr('fill', '#444').attr('font-size', 12)
        .text(cfg.xLabel);
      svg.append('text').attr('transform', `translate(14, ${margin.top + innerH/2}) rotate(-90)`)
        .attr('text-anchor', 'middle').attr('fill', '#444').attr('font-size', 12)
        .text(cfg.yLabel);

      const legend = panel.append('div').attr('class', 'legend');
      legend.append('span').html('<span class="swatch red"></span> Above Trend');
      legend.append('span').html('<span class="swatch blue"></span> Below Trend');
      legend.append('span').html('<span class="swatch avg"></span> Average Lines');
      
      let corrClass = 'corr-weak', corrLabel = 'Weak';
      if (r2 >= 0.5) { corrClass = 'corr-strong'; corrLabel = 'Strong'; }
      else if (r2 >= 0.25) { corrClass = 'corr-moderate'; corrLabel = 'Moderate'; }
      
      summary.append('span').attr('class', `correlation-badge ${corrClass}`)
        .style('margin-left', '12px')
        .html(`R²=${fmt3(r2)} (${corrLabel})`);

      if (cfg.insight) {
        panel.append('div').style('padding', '8px 14px 10px').style('font-size', '13px')
          .style('color', '#555').style('font-style', 'italic').text('💡 ' + cfg.insight);
      }
    }

    function render() {
      loadData().then(allRows => {
        const charts = [
          {
            xKey: 'wr1_share',
            yKey: 'win_pct',
            xLabel: 'WR1 Target Share (%)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Star Receiver Dependency',
            insight: 'Do teams need a dominant WR1 to win? Or is spreading the ball better?',
            extraInfo: d => `WR1: ${d.wr1_name} (${d.wr1_position})`,
            metricHelp: '<strong>WR1 Target Share:</strong> Prozentsatz der Pässe, die auf den Haupt-WR des Teams geworfen werden, gemessen an der Gesamtzahl der Pässe. Ein hoher Prozentsatz (>30%) = Abhängigkeit von einem Star.',
            quadrantHelp: {
              topRight: '⭐ Superstar-Formel: Das Team hat einen dominanten WR1 (>30% der Targets) und das führt zu Siegen. Der Quarterback vertraut einem Spieler in entscheidenden Momenten, die gegnerische Verteidigung kann diese Verbindung nicht stoppen. Der WR1 gewinnt 1-gegen-1-Matchups, besonders in Clutch-Situationen.',
              topLeft: '🎯 Demokratie siegt: Das Team gewinnt ohne klare Abhängigkeit von einem Receiver. Der QB liest das gesamte Feld, findet den offenen Mann. Für die Defense ist schwer vorherzusagen, wer den Ball bekommt. Das ist ein Zeichen für einen Elite-QB und einen tiefen WR-Kader.',
              bottomLeft: '😔 Krise im Luftangriff: Kein dominanter Receiver UND das Team verliert. Entweder kann der QB kein zuverlässiges Ziel finden oder die gesamte Receiver-Gruppe ist schwach. Das Team braucht dringend einen Playmaker im Passspiel.',
              bottomRight: '🤔 Talent ohne Ergebnis: Der WR1 erhält den Löwenanteil der Pässe, aber das Team verliert. Mögliche Gründe: Vorhersehbarkeit der Offense, schwache O-Line gibt dem QB keine Zeit, oder die Defense ist so schlecht, dass selbst ein Star-WR nicht rettet.'
            }
          },
          {
            xKey: 'te_target_share',
            yKey: 'win_pct',
            xLabel: 'TE Target Share (%)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Tight End Usage vs Winning',
            insight: 'Elite TEs are game-changers. Do teams that feature their TE win more?',
            extraInfo: d => `TE1: ${d.te1_name || 'N/A'}`,
            metricHelp: '<strong>TE Target Share:</strong> Prozentsatz der Fänge des Tight Ends an der Gesamtzahl der Fänge des Teams. Ein hoher Prozentsatz (>20%) = TE als Hauptwaffe im Passspiel.',
            quadrantHelp: {
              topRight: '⭐ Ära des Tight Ends: Das Team hat die Offense um einen Elite-TE (>20% der Targets) aufgebaut und das zahlt sich mit Siegen aus. Der TE schafft Mismatches: zu groß für Cornerbacks, zu schnell für Linebacker. Dominiert in der Red Zone, unersetzlich bei 3rd Down. Ein modernes Schema mit dem TE im Slot zerstört Zonenverteidigungen.',
              topLeft: '✅ WR-Maschine: Das Team gewinnt durch die Dominanz der Wide Receiver. Der TE erfüllt die Rolle eines Blockers oder Sicherheitsventils. Das ist ein klassischer vertikaler Angriffsstil, bei dem die Geschwindigkeit der WR das Feld streckt.',
              bottomLeft: '😔 Vernachlässigte Feldmitte: Das Team ignoriert die TE-Position und bezahlt dafür mit Niederlagen. Ohne Bedrohung in der Mitte kann die Defense die Außenzonen leicht abdecken. Dem Team fehlt ein zuverlässiger Spieler für kurze und mittlere Pässe.',
              bottomRight: '🤔 TE-Krücke: Das Team forciert Pässe auf den Tight End, aber das führt nicht zu Siegen. Vielleicht ist er der einzig zuverlässige Receiver wegen schwacher WRs, oder der QB sieht die tiefen Zonen nicht. Die Offense wird vorhersehbar und limitiert.'
            }
          },
          {
            xKey: 'rb_target_share',
            yKey: 'win_pct',
            xLabel: 'RB Target Share (% of catches)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Running Back Receiving Usage',
            insight: 'Pass-catching RBs create mismatches. Does featuring RBs in passing game correlate with wins?',
            extraInfo: d => `RB1: ${d.rb1_name}, RB2: ${d.rb2_name || 'N/A'}`,
            metricHelp: '<strong>RB Target Share:</strong> Prozentsatz der Fänge von RBs an der Gesamtzahl der Fänge. Ein hoher Prozentsatz (>25%) = aktive Nutzung des RBs im Passspiel oder Abwerfen des Balls unter Druck.',
            quadrantHelp: {
              topRight: '🏃 Doppelte RB-Bedrohung: Der Running Back fängt 25%+ der Pässe UND das Team gewinnt. Der RB geht in den Slot, schafft Mismatches gegen Linebacker, fängt Screens und Checkdowns. Die Defense kann keine schwere Front spielen – der RB entwischt zum Fang. Ein Albtraum für Defense-Koordinatoren.',
              topLeft: '🎯 Klassisch vertikal: Siege durch Dominanz von WR/TE, der RB bleibt im Backfield zum Blocken oder Laufen. Reiner Pocket-Passer-Stil – QB steht in der Pocket, WR laufen tiefe Routen. RB = Absicherung gegen den Blitz.',
              bottomLeft: '😔 Eindimensionale Schwäche: Der RB ist keine Bedrohung im Passspiel UND das Team verliert. Die Defense ignoriert den RB in der Coverage, konzentriert sich auf die WR. Vorhersehbare Offense: Wenn der RB im Spiel ist = Lauf, wenn nicht = Pass. Leicht zu verteidigen.',
              bottomRight: '⚠️ Panik unter Druck: Der RB fängt viele Pässe (25%+), aber das Team verliert. Das ist ein Symptom: Der QB wirft unter ständigem Druck zum RB ab, keine Zeit für die Entwicklung der WR-Routen. Die O-Line blockt nicht, die gesamte Offense basiert auf kurzen Abwürfen.'
            }
          },
          {
            xKey: 'pass_concentration',
            yKey: 'win_pct',
            xLabel: 'Pass Concentration (Herfindahl Index)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Passing Target Distribution',
            insight: 'Concentrated (high) = one star. Spread (low) = balanced. Which strategy wins more?',
            extraInfo: d => `Top 3: ${d.wr1_name}, ${d.wr2_name || 'N/A'}, ${d.wr3_name || 'N/A'}`,
            metricHelp: '<strong>Herfindahl-Index:</strong> Konzentrationsindex der Passverteilung (0-10000). >1500 = Konzentration auf einen Spieler, 1000-1500 = Balance, <1000 = gleichmäßige Verteilung auf viele Spieler.',
            quadrantHelp: {
              topRight: '⭐ Talent-Monopol: Index >1500 + Siege = ein Spieler erhält 35-40% aller Targets und dominiert. QB und WR1 sind auf einer Wellenlänge, jede Route ist automatisiert. Die Defense weiß, wohin der Ball fliegt, kann es aber nicht stoppen. Risiko: Verletzung des Stars = Zusammenbruch der Offense.',
              topLeft: '🎯 Schachpartie: Index <1000 + Siege = 5-6 Spieler teilen die Targets gleichmäßig auf. Der QB ist wie ein Dirigent, attackiert bei jedem Down die Schwachstelle der Defense. Unmöglich, alle zu doppeln. Ein Zeichen für hohen Football-IQ im gesamten Team.',
              bottomLeft: '😔 Angriff ohne Identität: Keine Konzentration (<1000) + Niederlagen = Chaos im Passspiel. Der QB hat keine zuverlässige erste Option, verteilt den Ball zufällig. Niemand übernimmt Verantwortung in kritischen Momenten. Es wird ein Anführer im Receiving Corps benötigt.',
              bottomRight: '🤔 Einseitige Abhängigkeit: Index >1500 + Niederlagen = die gesamte Offense lastet auf den Schultern eines Spielers, aber das ist nicht genug. Die gegnerische Defense doppelt/dreifacht den Star, die anderen WR können das nicht ausnutzen. WR2/WR3 müssen entwickelt oder das Schema geändert werden.'
            }
          },
          {
            xKey: 'rb1_share',
            yKey: 'win_pct',
            xLabel: 'RB1 Rush Share (%)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Bellcow RB vs Committee Approach',
            insight: 'Feature back (70%+) vs RBBC (50-60%). Does workhorse RB strategy win more?',
            extraInfo: d => `RB1: ${d.rb1_name} (${d.rb1_position}) - ${d.rush_distribution_style}`,
            metricHelp: '<strong>RB1 Share:</strong> Prozentsatz der Läufe des Haupt-RBs an der Gesamtzahl der Läufe. >70% = Bellcow (Hauptlastträger), 50-60% = RBBC (Komitee), <50% = Rotation.',
            quadrantHelp: {
              topRight: '💪 Arbeitspferd des Imperiums: RB1 trägt 70%+ der Läufe UND das Team gewinnt. Dieser Läufer ist das Metronom der Offense, 20-25 Versuche pro Spiel. Die Defense ermüdet von seinen Schlägen, das 4. Viertel = seine Zeit. Die O-Line kennt seinen Stil, perfektes Timing der Blocks. Stil "feed the beast".',
              topLeft: '🔄 Frische entscheidet: RBBC (50-60% für RB1) + Siege = clevere Rotation. Jeder RB hat eine Rolle: RB1 zwischen den Tackles, RB2 für Außenläufe, RB3 bei 3rd Down. Die Defense kann sich nicht auf einen Laufstil einstellen. Im 4. Viertel sind alle Läufer frisch.',
              bottomLeft: '😔 Komitee des Scheiterns: RBBC + Niederlagen = es gibt keinen RB, der das Spiel an sich reißen kann. Ständige Rotation zerstört den Rhythmus, die O-Line kann sich nicht an unterschiedliche Stile anpassen. Chaotisches Laufspiel ohne Identität.',
              bottomRight: '⚠️ Überlastetes Pferd: RB1 mit 70%+ der Läufe + Niederlagen = Überlastung ohne Ergebnis. Im 3. Viertel verliert der RB an Explosivität, aber es gibt keine Alternative. Möglicherweise ist die O-Line schwach oder das Play-Calling vorhersehbar. Verschleiß ohne Ertrag.'
            }
          },
          {
            xKey: 'top3_share',
            yKey: 'win_pct',
            xLabel: 'Top 3 Receivers Target Share (%)',
            yLabel: 'Win Percentage',
            xFormat: fmt1,
            yFormat: toPct,
            title: 'Top 3 Receiver Dominance',
            insight: 'High concentration in top 3 = star-driven offense. Low = depth & spreading the ball.',
            extraInfo: d => `Top 3: ${d.wr1_name}, ${d.wr2_name || 'N/A'}, ${d.wr3_name || 'N/A'}`,
            metricHelp: '<strong>Top 3 Share:</strong> Gesamtprozentsatz der Fänge der Top-3-Receiver an der Gesamtzahl. >75% = Konzentration auf Stars, <60% = tiefer Kader mit gleichmäßiger Verteilung.',
            quadrantHelp: {
              topRight: '⭐ Die Großen Drei regieren: Die Top 3 erhalten 75%+ der Targets UND gewinnen. Das Team hat eine WR1-WR2-WR3/TE-Triade, die der Defense keine Luft zum Atmen lässt. Einer im Slot, einer tief, einer auf mittlerer Distanz – immer ist jemand offen. Der QB hat drei zuverlässige Optionen bei jedem Down.',
              topLeft: '🎯 Armee der namenlosen Helden: <60% für die Top 3 + Siege = die Kadertiefe entscheidet. WR4, WR5, TE2 fangen regelmäßig wichtige Pässe. Die Defense bereitet sich auf die Stars vor, und ein unbekannter WR6 fängt den Touchdown. Ein Albtraum für das gegnerische Scouting.',
              bottomLeft: '😔 Wüste im Receiving Corps: Top 3 schwach (<60%) + Niederlagen = weder Stars noch Tiefe. Der QB ist gezwungen zu riskieren, indem er auf gedeckte Spieler wirft. Viele Panik-Abwürfe auf RBs. Dringend werden Drafts/Trades auf den WR-Positionen benötigt.',
              bottomRight: '🤔 Vorhersehbare Drei: Top 3 mit 75%+ der Targets + Niederlagen = die Defense weiß, wen sie decken muss. Bracket Coverage für WR1, Safety-Hilfe für WR2, physischer Corner für WR3. Die restlichen Receiver stellen keine Bedrohung dar. Es braucht ein neues Schema oder die Entwicklung von WR4+.'
            }
          },
          {
            xKey: 'pass_concentration',
            yKey: 'rush_concentration',
            xLabel: 'Pass Concentration',
            yLabel: 'Rush Concentration',
            xFormat: fmt1,
            title: 'Offensive Philosophy: Concentration Strategy',
            insight: 'Top-right = star-driven (both pass & rush). Bottom-left = committee approach on both.',
            extraInfo: d => `Pass: ${d.wr1_name} | Rush: ${d.rb1_name}`,
            metricHelp: '<strong>Angriffs-Philosophie:</strong> Vergleich der Konzentration im Pass- und Laufspiel. Oben rechts = Star-Taktik, unten links = kollektiver Ansatz.',
            quadrantHelp: {
              topRight: '⭐ Superstar-Philosophie: Hohe Konzentration SOWOHL im Pass- ALS AUCH im Laufspiel = Setzen auf 2-3 Elite-Spieler. WR1 + RB1 tragen den gesamten Angriff. Einfache Formel: Gib den Ball den besten Spielern. Hohes Risiko – eine Verletzung eines von ihnen lähmt den Angriff. Aber wenn sie gesund sind – unaufhaltsam.',
              topLeft: '🏃 Hybrid-Modell: RBBC + Star-WR = clevere Risikobalance. Im Passspiel gibt es einen Go-to-Guy für kritische Situationen, im Laufspiel sorgt Rotation für Frische. Die Defense kann sich nicht nur auf Pass oder Lauf konzentrieren.',
              bottomLeft: '🎯 Totale Demokratie: Überall niedrige Konzentration = 8-10 Spieler erhalten den Ball gleichmäßig. Niemand wird müde, alle sind involviert. Ideal zur Zeitkontrolle und Zermürbung der Defense. Minus: kein Held in Clutch-Momenten.',
              bottomRight: '🔄 Unausgewogener Ansatz: Star-WR + RBBC = Übergewicht zum Passspiel. Alle explosiven Plays laufen über einen Receiver, der Lauf dient nur der Alibi. Funktioniert gegen schwache Secondarys, ist aber anfällig für starken Pass Rush.'
            }
          },
          {
            xKey: 'wr_target_share',
            yKey: 'te_target_share',
            xLabel: 'WR Target Share (%)',
            yLabel: 'TE Target Share (%)',
            xFormat: fmt1,
            title: 'WR vs TE Usage Balance',
            insight: 'WR-heavy offense (high X, low Y) vs TE-heavy (low X, high Y). Strategic preference.',
            extraInfo: d => `WR1: ${d.wr1_name} | TE1: ${d.te1_name || 'N/A'}`,
            metricHelp: '<strong>WR/TE-Balance:</strong> Vergleicht die Nutzung von Wide Receivern (WR) gegenüber Tight Ends (TE). Zeigt die strategischen Vorlieben des Teams im Passspiel.',
            quadrantHelp: {
              topRight: '🎯 Volles Arsenal: WR 60%+ und TE 20%+ = die Offense nutzt das ganze Feld. WR ziehen die Defense horizontal auseinander, TE attackiert die Nahtstellen in der Mitte. Albtraum für den Defensive Coordinator: Cover 2 – TE zerreißt die Mitte, Cover 3 – WR finden Lücken. Moderner, mehrstufiger Angriff.',
              topLeft: '💪 Power-Stil: TE 25%+ bei WR <50% = Spiel über den Tight End und kurze Zonen. 12/13 Personnel dominiert, 2-3 TEs auf dem Feld. Power Run mit Play Action auf den TE. Langsamer, methodischer Stil der Ballkontrolle. Ideal bei schlechtem Wetter.',
              bottomLeft: '🏃 Checkdown City: Niedrige WR- und TE-Nutzung = alle Pässe gehen an RBs und Slots. Entweder hält die O-Line nicht und der QB wirft schnell ab, oder das Schema basiert auf Screens und Draws. Die Defense spielt in der Box, die tiefen Zonen sind leer.',
              bottomRight: '🚀 Vertikaler Angriff: WR 70%+ bei TE <10% = 11 Personnel, 3-4 WR immer auf dem Feld. Spread Offense, hohes Tempo, Auseinanderziehen der Defense. TE blockt nur. Setzt auf Geschwindigkeit und Athletik der WR. Funktioniert in Hallen/bei gutem Wetter.'
            }
          },
          {
            xKey: 'wr1_share',
            yKey: 'top3_share',
            xLabel: 'WR1 Share (%)',
            yLabel: 'Top 3 Share (%)',
            xFormat: fmt1,
            title: 'Alpha Receiver vs Supporting Cast',
            insight: 'High both = one star + good #2/#3. High top3, low WR1 = balanced trio.',
            extraInfo: d => `Top 3: ${d.wr1_name}, ${d.wr2_name || 'N/A'}, ${d.wr3_name || 'N/A'}`,
            metricHelp: '<strong>Alpha-Receiver:</strong> Abhängigkeit von WR1 im Verhältnis zu den Top 3. Hohe Werte bei beiden = ein Star + gute #2/#3. Hoher Top-3-Wert, niedriger WR1-Wert = ausgewogenes Trio.',
            quadrantHelp: {
              topRight: '⭐ Alpha-Wolf mit Rudel: WR1 30%+ und Top 3 75%+ = es gibt einen klaren Anführer, aber WR2/WR3 sind auch gefährlich. WR1 erfordert Double Team, das öffnet WR2/WR3 für Big Plays. Die Defense steckt in der Falle: Fokus auf WR1 – die anderen punkten; WR1 ignorieren – er zerreißt das Spiel.',
              topLeft: '🎯 Gleichberechtigtes Trio: Top 3 stark (75%+), aber die Last ist verteilt (WR1 <25%). Drei etwa gleich starke Receiver, QB wählt nach Matchup. Kein Superstar, aber drei sehr gute Spieler. Schwierig für das Game Planning der Defense.',
              bottomLeft: '😔 WR-Wüste: Weder Alpha (<25% WR1) noch starke Top 3 (<60% Top 3) = Katastrophe im Receiving Corps. QB verteilt den Ball auf 6-7 mittelmäßige Spieler in der Hoffnung auf ein Wunder. Viele Drops, wenig Separation. Kompletter Umbau des WR-Raums nötig.',
              bottomRight: '🤔 Einsamer Held: WR1 trägt 35%+ bei Top 3 <65% = WR2/WR3 existieren quasi nicht. Das gesamte Passspiel lastet auf den Schultern eines Spielers. Die Defense kann sich Triple Coverage für WR1 leisten, da die anderen ungefährlich sind. WR1 fängt umkämpfte Pässe, aber das ist kein nachhaltiges Modell. Dringend Upgrades auf WR2/WR3-Positionen benötigt.'
            }
          },
          {
            xKey: 'rb1_share',
            yKey: 'rb2_share',
            xLabel: 'RB1 Rush Share (%)',
            yLabel: 'RB2 Rush Share (%)',
            xFormat: fmt1,
            title: 'Running Back Committee Analysis',
            insight: 'Top-right quadrant = true RBBC (both get work). High X, low Y = clear bellcow.',
            extraInfo: d => `RB1: ${d.rb1_name} | RB2: ${d.rb2_name || 'N/A'}`,
            metricHelp: '<strong>RB-Komitee:</strong> Analyse der Laufverteilung zwischen RB1 und RB2. Oberer rechter Quadrant = echtes RBBC (beide bekommen Arbeit), hoher X-Wert niedriger Y-Wert = klarer Bellcow.',
            quadrantHelp: {
              topRight: '🔄 Echtes RBBC – beide Läufer bekommen Arbeit, 50/50-Split oder 60/40',
              topLeft: '🤔 RB2 dominiert – möglicherweise Verletzung von RB1 oder seltsame Situation',
              bottomLeft: '😔 Schwaches Laufspiel – weder RB1 noch RB2 werden aktiv genutzt',
              bottomRight: '💪 Bellcow dominiert – RB1 erhält 70%+ der Läufe, klarer Hauptspieler'
            }
          },
          {
            xKey: 'wr1_share',
            yKey: 'pass_int_pct',
            xLabel: 'WR1 Target Share (%)',
            yLabel: 'INT Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Star WR Dependency vs Interception Risk',
            insight: 'Does forcing the ball to one receiver make passing predictable? Check if high WR1 usage = more INTs.',
            metricHelp: '<strong>INT Rate:</strong> Prozentsatz der Interceptions an der Gesamtzahl der Pässe. Zeigt, ob die Abhängigkeit von einem WR zu vorhersehbaren Pässen und Interceptions führt.',
            extraInfo: d => `WR1: ${d.wr1_name} - ${fmt2(d.pass_int_pct)}% INT rate`,
            quadrantHelp: {
              topRight: '😱 Gefährliche Abhängigkeit – viele Pässe auf WR1 + viele Interceptions, vorhersehbares Spiel',
              topLeft: '🎯 Verteilung schützt – Ball verteilt + viele INT, möglicherweise QB-Probleme',
              bottomLeft: '✅ Kluges Spiel – Ball verteilt + wenig Interceptions, unvorhersehbarer Angriff',
              bottomRight: '⭐ Elite-WR1 – Konzentration auf den Star, aber wenig INT, der Star wird frei'
            }
          },
          {
            xKey: 'rb1_share',
            yKey: 'rush_broken_tackle_rate',
            xLabel: 'RB1 Rush Share (%)',
            yLabel: 'Broken Tackles per Rush (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Bellcow Power: Workload vs Physicality',
            insight: 'Do feature backs break more tackles because they\'re elite, or do committees stay fresher?',
            extraInfo: d => `RB1: ${d.rb1_name} - ${fmt2(d.rush_broken_tackle_rate)}% broken tackle rate`,
            quadrantHelp: {
                topRight: '💪 Elite-Bellcow – hohe Last + bricht Tackles, physisch dominanter Läufer',
                topLeft: '🔄 Frische Beine funktionieren – RBBC bricht Tackles, Rotation gibt Kraft',
                bottomLeft: '😔 Schwaches Laufspiel – wenig Last + wenig gebrochene Tackles, Probleme',
                bottomRight: '⚠️ Ermüdung zeigt sich – hohe Last, aber wenig gebrochene Tackles, Läufer ist müde'
            }
          },
          {
            xKey: 'pass_concentration',
            yKey: 'sack_rate',
            xLabel: 'Pass Concentration Index',
            yLabel: 'Sack Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Predictability Tax: Target Concentration vs Sacks',
            insight: 'Concentrated passing = defenders know where ball goes = more pressure? Or is it just bad O-lines?',
            extraInfo: d => `WR1: ${d.wr1_name} - ${fmt2(d.sack_rate)}% sack rate`,
            metricHelp: '<strong>Sack Rate:</strong> Prozentsatz der Sacks von (Versuche + Sacks). Konzentration auf einen Receiver = Vorhersehbarkeit = mehr Sacks?',
            quadrantHelp: {
              topRight: '😱 Steuer für Vorhersehbarkeit – Konzentration auf WR1 + viele Sacks, Defense kennt den Plan',
              topLeft: '⚠️ Schlechte O-Line – Ball verteilt, aber viele Sacks, Problem beim Linienschutz',
              bottomLeft: '✅ Guter Schutz + Verteilung – Ball verteilt + wenig Sacks, ausgezeichnet',
              bottomRight: '⭐ Elite-WR rettet – Konzentration auf Star, aber wenig Sacks, wird schnell frei'
            }
          },
          {
            xKey: 'te_target_share',
            yKey: 'sack_rate',
            xLabel: 'TE Target Share (%)',
            yLabel: 'Sack Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 TE Usage: Weapon or Safety Blanket?',
            insight: 'High TE usage with low sacks = protection weapon. High TE + high sacks = last resort checkdown.',
            extraInfo: d => `TE1: ${d.te1_name || 'N/A'} - ${fmt2(d.sack_rate)}% sack rate`,
            metricHelp: '<strong>TE + Sacks:</strong> Hohe TE-Nutzung bei wenigen Sacks = Schutzwaffe. Hohe Werte bei beidem = letztes Mittel unter Druck.',
            quadrantHelp: {
              topRight: '⚠️ TE als Panik-Knopf – viel TE + viele Sacks, Abwurf unter Druck',
              topLeft: '😔 Schlechte O-Line ohne TE-Hilfe – wenig TE + viele Sacks, muss TE mehr nutzen',
              bottomLeft: '✅ Kein Sicherheitsventil nötig – wenig TE + wenig Sacks, gute O-Line',
              bottomRight: '💪 TE als Waffe – viel TE + wenig Sacks, strategische Nutzung des Tight Ends'
            }
          },
          {
            xKey: 'top3_share',
            yKey: 'yds_per_play',
            xLabel: 'Top 3 Target Share (%)',
            yLabel: 'Yards per Play',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Star Power vs Offensive Efficiency',
            insight: 'Elite receivers unlock efficiency? Or does spreading it around keep defenses honest?',
            extraInfo: d => `Top 3: ${d.wr1_name}, ${d.wr2_name || 'N/A'}, ${d.wr3_name || 'N/A'}`,
            metricHelp: '<strong>Yards per Play:</strong> Durchschnittliche Yards pro Spielzug. Schalten Elite-Receiver Effizienz frei oder hält die Ballverteilung die Defense in Atem?',
            quadrantHelp: {
              topRight: '⭐ Stars schalten Effizienz frei – Top 3 dominieren + hohe Yards pro Spielzug',
              topLeft: '🎯 Tiefe schafft Effizienz – Verteilung + hohe Yards, Defense ist verwirrt',
              bottomLeft: '😔 Schwacher Angriff – keine Stars + niedrige Yards, Probleme überall',
              bottomRight: '🤔 Stars helfen nicht – Top 3 dominieren, aber niedrige Yards, vorhersehbar'
            }
          },
          {
            xKey: 'rush_concentration',
            yKey: 'rush_yds_per_att',
            xLabel: 'Rush Concentration Index',
            yLabel: 'Rush Yards per Attempt',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Bellcow Effectiveness Test',
            insight: 'Does feeding one back work? Or do fresh legs from RBBC produce better yards per carry?',
            extraInfo: d => `RB1: ${d.rb1_name} - ${fmt2(d.rush_yds_per_att)} Y/A`,
            metricHelp: '<strong>Rush Y/A:</strong> Yards pro Lauf. Effizienztest: Ein Läufer vs. frische Beine des Komitees – wer produziert mehr Yards?',
            quadrantHelp: {
              topRight: '💪 Bellcow ist effektiv – ein Läufer + hohe Yards pro Lauf, Elite-RB',
              topLeft: '🔄 RBBC funktioniert – frische Beine + hohe Yards, Rotation bringt Ergebnisse',
              bottomLeft: '😔 Schwaches Laufspiel – Komitee + niedrige Yards, keine Qualitätsläufer',
              bottomRight: '⚠️ Bellcow ermüdet – ein Läufer + niedrige Yards, Müdigkeit oder schlechte O-Line'
            }
          },
          {
            xKey: 'wr1_share',
            yKey: 'qb_rating',
            xLabel: 'WR1 Target Share (%)',
            yLabel: 'QB Rating',
            xFormat: fmt1,
            yFormat: fmt1,
            title: '💥 Star WR Impact on QB Performance',
            insight: 'Elite WR1 elevates QB play? Or does elite QB make his WR1 look great? Chicken or egg?',
            metricHelp: '<strong>QB Rating:</strong> Quarterback-Rating. Hebt ein Elite-WR1 das QB-Spiel an oder macht ein Elite-QB seinen WR1 zum Star? Huhn oder Ei?',
            extraInfo: d => `${d.wr1_name}: ${fmt1(d.wr1_share)}% share → ${fmt1(d.qb_rating)} QB rating`,
            quadrantHelp: {
              topRight: '⭐ WR1 hebt QB an – Konzentration auf Star + hohes QB-Rating, Elite-Duo',
              topLeft: '🎯 QB verteilt an alle – Verteilung + hohes QB-Rating, kluger Quarterback',
              bottomLeft: '😔 Schwaches Passspiel – kein Star + niedriges QB-Rating, Probleme im Passspiel',
              bottomRight: '🤔 WR1 hilft QB nicht – Konzentration auf Star, aber niedriges QB-Rating, Abhängigkeit funktioniert nicht'
            }
          },
          {
            xKey: 'rb_target_share',
            yKey: 'pass_yds_per_att',
            xLabel: 'RB Target Share (%)',
            yLabel: 'Pass Yards per Attempt',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 RB Checkdown Strategy: Smart or Desperate?',
            insight: 'High RB targets + high Y/A = designed weapon. High RB targets + low Y/A = QB under pressure dumping off.',
            extraInfo: d => `RB1: ${d.rb1_name} - ${fmt2(d.pass_yds_per_att)} Y/A`,
            metricHelp: '<strong>Pass Y/A:</strong> Yards pro Passversuch. Viele RB-Pässe + hohes Y/A = Waffe. Viele RB-Pässe + niedriges Y/A = Abwurf unter Druck.',
            quadrantHelp: {
              topRight: '💪 RB als Waffe – viele Pässe auf RB + hohes Y/A, strategische Mismatches',
              topLeft: '🎯 Effektiver vertikaler Pass – wenig RB + hohes Y/A, Angriff über WR/TE',
              bottomLeft: '😔 Schwaches Passspiel – wenig RB + niedriges Y/A, Probleme auf allen Positionen',
              bottomRight: '⚠️ Verzweifelte Abwürfe – viel RB + niedriges Y/A, QB wirft unter Druck ab'
            }
          },
          {
            xKey: 'pass_concentration',
            yKey: 'explosive_plays_per_game',
            xLabel: 'Pass Concentration Index',
            yLabel: 'Explosive Plays (20+) per Game',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Distribution Strategy vs Big Plays',
            insight: 'Does spreading the ball create more explosive opportunities? Or do stars make the big plays?',
            extraInfo: d => `WR1: ${d.wr1_name} - ${fmt2(d.explosive_plays_per_game)} explosive plays/game`,
            metricHelp: '<strong>Explosive Plays:</strong> Spielzüge 20+ Yards pro Spiel. Schafft die Ballverteilung mehr explosive Momente oder machen die Stars die Big Plays?',
            quadrantHelp: {
              topRight: '⭐ Star macht Big Plays – Konzentration auf WR1 + explosive Spielzüge, Elite-Spieler',
              topLeft: '🎯 Tiefe schafft Explosionen – Verteilung + explosive Spiele, viele Bedrohungen',
              bottomLeft: '😔 Keine Big Plays – Verteilung + wenig explosive Plays, keine Playmaker',
              bottomRight: '🤔 Star nicht explosiv – Konzentration auf WR1, aber wenig Big Plays, kurze Pässe'
            }
          },
          {
            xKey: 'rush_concentration',
            yKey: 'total_turnovers',
            xLabel: 'Rush Concentration Index',
            yLabel: 'Total Turnovers',
            xFormat: fmt1,
            yFormat: fmt1,
            title: '💥 Ball Security: Bellcow vs Committee',
            insight: 'Feature backs fumble more from fatigue? Or do committees have worse ball security?',
            extraInfo: d => `RB1: ${d.rb1_name} | RB2: ${d.rb2_name || 'N/A'}`,
            metricHelp: '<strong>Turnovers:</strong> Gesamtballverluste. Fumbeln Haupt-Läufer mehr wegen Müdigkeit oder haben Komitees schlechtere Ballkontrolle?',
            quadrantHelp: {
              topRight: '😱 Bellcow + viele Ballverluste – Müdigkeit führt zu Fumbles, hohe Last schadet',
              topLeft: '⚠️ Komitee + viele Ballverluste – mehrere Läufer, aber alle verlieren den Ball, allgemeines Problem',
              bottomLeft: '✅ Komitee passt auf Ball auf – frische Beine + gute Ballkontrolle',
              bottomRight: '💪 Bellcow zuverlässig – hohe Last, aber wenig Ballverluste, Elite-Ballkontrolle'
            }
          },
          {
            xKey: 'wr_target_share',
            yKey: 'pass_td_pct',
            xLabel: 'WR Target Share (%)',
            yLabel: 'Pass TD Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 WR-Heavy Offense Scoring Efficiency',
            insight: 'WR-centric attacks score more TDs? Or are TEs/RBs better in the red zone?',
            extraInfo: d => `WR1: ${d.wr1_name} | TE1: ${d.te1_name || 'N/A'}`,
            metricHelp: '<strong>Pass TD Rate:</strong> Prozentsatz der Touchdowns von Passversuchen. Erzielen WR-zentrierte Angriffe mehr TDs oder sind TEs/RBs in der Red Zone besser?',
            quadrantHelp: {
              topRight: '🎯 WR dominieren in der Red Zone – viele Pässe auf WR + hohe TD%, effektiv',
              topLeft: '💪 TE/RB erzielen TDs – wenig WR + hohe TD%, Tight Ends und Backs in der Red Zone',
              bottomLeft: '😔 Schwacher Red Zone Angriff – wenig WR + niedrige TD%, Probleme beim Scoren',
              bottomRight: '🤔 WR scoren nicht – viele Pässe auf WR, aber niedrige TD%, Ineffizienz in der Red Zone'
            }
          },
          {
            xKey: 'te_target_share',
            yKey: 'pass_comp_pct',
            xLabel: 'TE Target Share (%)',
            yLabel: 'Completion Percentage',
            xFormat: fmt1,
            yFormat: fmt1,
            title: '💥 TE Usage: High-Percentage Safety Valve',
            insight: 'TEs are easier throws = higher completion %? Proof that TEs are the ultimate security blanket.',
            extraInfo: d => `TE1: ${d.te1_name || 'N/A'} - ${fmt1(d.pass_comp_pct)}% comp`,
            metricHelp: '<strong>Completion %:</strong> Prozentsatz abgeschlossener Pässe. TE = leichtere Würfe = höherer Prozentsatz? Beweis, dass TE die ultimative Absicherung ist.',
            quadrantHelp: {
              topRight: '💪 TE als Sicherheitsventil – viel TE + hohe Completion %, leichte Pässe funktionieren',
              topLeft: '🎯 Präziser Pass ohne TE – wenig TE + hohe Completion %, Elite-QB oder gute WR',
              bottomLeft: '😔 Geringe Präzision ohne TE – wenig TE + niedrige Completion %, QB- oder WR-Probleme',
              bottomRight: '🤔 TE helfen nicht – viel TE, aber niedrige Completion %, Problem beim QB'
            }
          },
          {
            xKey: 'top3_share',
            yKey: 'turnover_diff',
            xLabel: 'Top 3 Target Share (%)',
            yLabel: 'Turnover Differential',
            xFormat: fmt1,
            yFormat: fmt1,
            title: '💥 Star Receivers & Ball Protection',
            insight: 'Elite receivers protect the ball better? Or are teams with top WRs just better overall?',
            extraInfo: d => `Top 3: ${d.wr1_name}, ${d.wr2_name || 'N/A'}, ${d.wr3_name || 'N/A'}`,
            metricHelp: '<strong>Turnover Diff:</strong> Ballverlustdifferenz (Ballgewinne - Ballverluste). Passen Elite-Receiver besser auf den Ball auf oder sind Teams mit Top-WR einfach insgesamt besser?',
            quadrantHelp: {
              topRight: '⭐ Stars + Ballkontrolle – Top 3 dominieren + positive Turnover-Diff, komplettes Team',
              topLeft: '🎯 Tiefe + Kontrolle – Verteilung + positive Diff, Teamspiel',
              bottomLeft: '😔 Keine Stars + verlieren Ball – Verteilung + negative Diff, schwaches Team',
              bottomRight: '🤔 Stars retten nicht – Top 3 dominieren, aber negative Diff, Probleme in anderen Bereichen'
            }
          },
          {
            xKey: 'rb1_share',
            yKey: 'rush_td_pct',
            xLabel: 'RB1 Rush Share (%)',
            yLabel: 'Rush TD Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Goal Line Back: Who Gets the Glory?',
            insight: 'Bellcows dominate goal-line work? Or do committees rotate in fresh power backs for TDs?',
            extraInfo: d => `RB1: ${d.rb1_name} | RB2: ${d.rb2_name || 'N/A'}`,
            metricHelp: '<strong>Rush TD Rate:</strong> Prozentsatz der Touchdowns von Läufen. Dominieren Bellcows an der Goal Line oder rotieren Komitees Power Backs für TDs rein?',
            quadrantHelp: {
              topRight: '💪 Bellcow erzielt TDs – hohe Last + hohe TD%, RB1 dominiert in der Red Zone',
              topLeft: '🔄 Goal Line Spezialist – RBBC + hohe TD%, rotieren Power Back für TDs',
              bottomLeft: '😔 Schwacher Laufangriff – RBBC + niedrige TD%, scoren nicht am Boden',
              bottomRight: '🤔 Bellcow scort nicht – hohe Last, aber niedrige TD%, wird nicht in der Red Zone eingesetzt'
            }
          },
          {
            xKey: 'pass_concentration',
            yKey: 'drop_rate',
            xLabel: 'Pass Concentration Index',
            yLabel: 'Drop Rate (%)',
            xFormat: fmt1,
            yFormat: fmt2,
            title: '💥 Target Overload: Does WR1 Drop More?',
            insight: 'Feeding one receiver = more drops from fatigue? Or do elite WRs have better hands?',
            extraInfo: d => `WR1: ${d.wr1_name} - ${fmt2(d.drop_rate)}% drop rate`,
            metricHelp: '<strong>Drop Rate:</strong> Prozentsatz der fallen gelassenen Pässe von Zielen. Einen Receiver füttern = mehr Drops durch Müdigkeit oder haben Elite-WR bessere Hände?',
            quadrantHelp: {
              topRight: '😱 Müdigkeit WR1 – Konzentration auf Star + hohe Drop Rate, Überlastung führt zu Fehlern',
              topLeft: '⚠️ Hände-Problem – Verteilung + hohe Drop Rate, allgemeines Problem des Corps',
              bottomLeft: '✅ Zuverlässiges Corps – Verteilung + niedrige Drop Rate, alle fangen gut',
              bottomRight: '⭐ Elite-WR1 – Konzentration + niedrige Drop Rate, zuverlässige Hände des Stars'
            }
          },
          {
            xKey: 'rb_target_share',
            yKey: 'rec_yac_pct',
            xLabel: 'RB Target Share (%)',
            yLabel: 'YAC % (of receiving yards)',
            xFormat: fmt1,
            yFormat: fmt1,
            title: '💥 RB Receptions: YAC Machines or Dump-offs?',
            insight: 'High RB targets + high YAC% = dynamic weapons. High RB + low YAC% = desperation checkdowns at LOS.',
            extraInfo: d => `RB1: ${d.rb1_name} - ${fmt1(d.rec_yac_pct)}% YAC`,
            metricHelp: '<strong>YAC %:</strong> Prozentsatz der Yards nach dem Fang. Viele RB-Pässe + hohes YAC% = dynamische Waffe. Viel RB + niedriges YAC% = Abwurf an der Linie.',
            quadrantHelp: {
              topRight: '💪 RB als YAC-Maschine – viele Pässe auf RB + hohes YAC%, dynamische Waffe',
              topLeft: '🎯 WR schaffen YAC – wenig RB + hohes YAC%, Receiver sammeln nach dem Fang',
              bottomLeft: '😔 Niedriges YAC überall – wenig RB + niedriges YAC%, Probleme nach dem Fang',
              bottomRight: '⚠️ Dump-offs an der Linie – viel RB + niedriges YAC%, verzweifelte Abwürfe unter Druck'
            }
          }
        ];

        const root = d3.select('#root');
        const sel = d3.select('#conf');

        function redraw() {
          const conf = sel.node().value;
          root.selectAll('*').remove();
          const filtered = conf === 'ALL' ? allRows : allRows.filter(d => d.conference === conf);
          charts.forEach(cfg => drawScatter(root, filtered, cfg));
        }

        sel.on('change', redraw);
        redraw();
      });
    }

    document.addEventListener('DOMContentLoaded', render);
  </script>
</head>
<body>
  <div class="container">
    <h1>Team Player Usage Patterns</h1>
    <div class="subtitle">
      25 graphs combining player usage distribution with team performance. Red = above trend, Blue = below trend.
      Reveals star-driven vs committee approaches and their impact on efficiency, turnovers, and scoring.
    </div>
    <div class="controls">
      <label for="conf">Conference:</label>
      <select id="conf">
        <option value="ALL" selected>All Conferences</option>
        <option value="AFC">AFC only</option>
        <option value="NFC">NFC only</option>
      </select>
    </div>
    <div class="info">
      <strong>Usage Patterns Explained:</strong>
      <ul style="margin: 6px 0 0; padding-left: 20px; line-height: 1.6;">
        <li><strong>Star-Driven</strong>: High concentration (Herfindahl > 1500) - One dominant player gets majority of touches</li>
        <li><strong>Balanced</strong>: Moderate concentration (1000-1500) - Feature player with solid supporting cast</li>
        <li><strong>Committee/Spread</strong>: Low concentration (< 1000) - Multiple players share workload evenly</li>
        <li><strong>Bellcow RB</strong>: RB1 gets 70%+ of rushes - Traditional workhorse back</li>
        <li><strong>RBBC (Running Back By Committee)</strong>: RB1 < 60%, RB2 > 25% - Split backfield</li>
      </ul>
    </div>
    <div id="root"></div>
  </div>
</body>
</html>
